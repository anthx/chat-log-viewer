<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chat Logs</title>
    <style type="text/css">
    	body {
    		font-family: 'Arial', 'Helvetica', sans-serif;
    	}
    	.bundle {
    		/*width: 40%;*/
			margin: 4pt;
			border: black thin solid;
			border-radius: 5pt;
			clear: both;
			padding: 5pt;
			/*float: left;*/
    	}
    	
    	.me {
    		float: right;
    		text-align: right;
    		clear: both;
    	}
    	
    	.message {
    		margin: 2pt;
            white-space: pre-wrap;
            margin-left: 20%;
    	}

        .metadata {

        }
    </style>
</head>
<body>
<h1>Number of messages: {{chat._messages|length}}</h1>
{% for key, msg in chat._messages.items() %}
	{% if key == 1%}
	<div class="bundle {% if msg.is_user %}me{% endif %}">
        <div class="metadata">At: {{msg.time_date_sender}} wrote:</div>
        <p class="message">{{msg.contents}}</p>
	{% endif %}

	{% if key > 1 and msg.time_date_sender == chat._messages[key-1].time_date_sender %}
        <div>
            <p class="message">{{msg.contents}}</p>
        </div>
    {% endif %}

    {% if key > 1 and msg.time_date_sender != chat._messages[key-1].time_date_sender %}
    </div>
    <div class="bundle {% if msg.is_user %}me{% endif %}">
        <div class="metadata">At: {{msg.timestamp.date()}} {{msg.timestamp.time()}}, {{msg.get_sender_name()}} wrote:</div>
        <p class="message">{{msg.contents}}</p>
    {% endif %}


{% endfor %}
    </div>
</body>
</html>